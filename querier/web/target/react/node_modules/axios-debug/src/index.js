import chalk from 'chalk';

const debug = (content) => {
  const outputString = typeof content === 'string' ? content : JSON.stringify(content, null, 4);
  console.log(chalk.cyan(outputString));
};

const Log = {
  debug,
};

let requestInterceptor;
let responseInterceptor;

const initiateDebug = (axiosInstance) => {
  if (requestInterceptor) axiosInstance.interceptors.eject(requestInterceptor);
  if (responseInterceptor) axiosInstance.interceptors.eject(responseInterceptor);

  requestInterceptor = axiosInstance.interceptors.request.use((config) => {
    Log.debug('Request:');
    Log.debug(config);
    return config;
  }, (error) => {
    Log.debug('Error:');
    Log.debug(error);
    return Promise.reject(error);
  });

  responseInterceptor = axiosInstance.interceptors.response.use((response) => {
    Log.debug('Response:');
    Log.debug(response);
    return response;
  }, (error) => {
    Log.debug('Error:');
    Log.debug(error);
    return Promise.reject(error);
  });
};

initiateDebug(axios);

export default axios;
